# Система управления заявками на потолки

Система состоит из двух Telegram ботов и веб-админки для управления заявками на установку потолков.

## Компоненты системы

1. **Основной бот** (`bot/bot.py`) - принимает заявки от клиентов
2. **Админ-бот** (`admin_bot/admin_bot.py`) - управление заявками через Telegram
3. **Веб-админка** (`web/app.py`) - веб-интерфейс для управления

## Настройка

### 1. Создание ботов

Создайте двух ботов через @BotFather:
- Основной бот для приема заявок
- Админ-бот для управления

### 2. Настройка .env файла

Создайте файл `.env` в корне проекта:

```env
# Токен основного бота
BOT_TOKEN=your_main_bot_token_here

# Токен админ-бота
ADMIN_BOT_TOKEN=your_admin_bot_token_here

# Настройки админки
ADMIN_USERS=admin
ADMIN_PASSWORDS=admin

# Пути к базе данных и загрузкам
DB_PATH=database/bot.db
UPLOAD_FOLDER=database/uploads
```

### 3. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 4. Запуск системы

```bash
chmod +x activate_bot.sh
./activate_bot.sh
```

Это запустит:
- Основной бот (прием заявок)
- Админ-бот (управление заявками)
- Веб-админка (http://127.0.0.1:5000)

## Функционал

### Основной бот
- Прием заявок от клиентов
- Отправка примеров работ
- Расчет стоимости
- Запись на замер

### Админ-бот
- Просмотр всех заявок
- Просмотр заявок в работе
- Прайс материалов и услуг
- Управление подрядчиками (в разработке)
- Кнопки "Принять в работу" и "Отдать на подряд"

### Веб-админка
- Просмотр и управление заявками
- Настройка цен материалов и услуг
- Управление выходными днями
- Управление подрядчиками

## Структура проекта

```
forRoman/
├── bot/                    # Основной бот
│   ├── bot.py             # Главный файл бота
│   ├── fsm_handlers.py    # Обработчики состояний
│   ├── materials.py       # Цены материалов и услуг
│   ├── calendar.py        # Календарь для записи
│   └── photos/            # Примеры работ
├── admin_bot/             # Админ-бот
│   ├── admin_bot.py       # Главный файл админ-бота
│   └── notifications.py   # Уведомления о заявках
├── web/                   # Веб-админка
│   ├── app.py            # Flask приложение
│   └── templates/        # HTML шаблоны
├── database/             # База данных
│   ├── init_db.py        # Инициализация БД
│   └── uploads/          # Загруженные фото
├── activate_bot.sh       # Скрипт запуска
└── requirements.txt      # Зависимости
```

## Логи

- `bot.log` - логи основного бота
- `admin_bot.log` - логи админ-бота  
- `admin.log` - логи веб-админки

## Резервное копирование

При каждом запуске создается резервная копия базы данных в `database/bot.db.backup_YYYYMMDD_HHMMSS` 